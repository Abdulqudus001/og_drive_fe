(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{602:function(e,t,r){var content=r(667);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(15).default)("6395713c",content,!0,{sourceMap:!1})},666:function(e,t,r){"use strict";var l=r(602);r.n(l).a},667:function(e,t,r){(t=r(14)(!1)).push([e.i,".my-drive[data-v-2dab03d1]{height:84vh;padding:20px 20px 50px;position:relative;overflow-y:auto}.my-drive .link[data-v-2dab03d1]{text-decoration:none;color:rgba(0,0,0,.87)}.files[data-v-2dab03d1]{display:grid;grid-template-columns:repeat(auto-fit,minmax(215px,215px));justify-content:center;grid-gap:10px;gap:10px}@media only screen and (min-width:768px){.files[data-v-2dab03d1]{justify-content:flex-start}}.shadow[data-v-2dab03d1] .v-input__slot{box-shadow:1px 4px 7px rgba(68,86,108,.1)!important}.file-details[data-v-2dab03d1]{list-style-type:none}.file-actions[data-v-2dab03d1]{width:100%;max-height:50px}.file-actions a[data-v-2dab03d1]{height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;text-decoration:none}.divider[data-v-2dab03d1]{width:100%;height:1px}.small--text[data-v-2dab03d1]{font-size:14px}",""]),e.exports=t},701:function(e,t,r){"use strict";r.r(t);r(12),r(10),r(7),r(3),r(9);var l=r(24),n=(r(38),r(27),r(37),r(67),r(1)),o=r(25),c=r(430),d=r.n(c),f=r(610),v=r(611),h=r(40),m=r(574),_=r(8);function w(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function F(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?w(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):w(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var D={layout:"adminDrive",components:{SuperAdminFile:f.a,SuperAdminFolder:v.a,Loader:h.a,Preview:m.a},middleware:"authenticated",filters:{date:function(e){return e?d()(e).format("MMMM Do YYYY"):null}},data:function(){return{tempDate:new Date(2020,3,22),searchFiles:"",fileTypes:["pdf","Spreadsheets","Presentations"],fileType:"",selectedFiles:[],selectedFolders:[],loading:!1,error:{status:!1,message:""},success:{status:!1,message:""},loadingDetails:!1,fileDetails:"",showDrawer:!1,currentFileName:"",currentFolderName:"",showDialog:!1,showFolderDialog:!1,fileName:"",folderName:"",fileToDeleteDetails:[],folderToDeleteDetails:[],showPreview:!1,previewData:null}},computed:F({},Object(o.b)(["getBreadCrumbs","getFiles","isLoggedIn","getFolders","getUser","getUserDirectories","getUserDetails","getUserFolders"]),{allUsers:function(){return this.$store.state.allUsers.users},id:function(){return this.$route.params.id},user:function(){var e=this;return this.allUsers.find((function(t){return t.ogId===e.id}))},filteredFiles:function(){var e=this;return this.globalSearchFiles?this.globalSearchFiles.filter((function(t){return t.filename.toLowerCase().includes(e.searchFiles.toLowerCase())})):this.getFiles.filter((function(t){return t.filename.toLowerCase().includes(e.searchFiles.toLowerCase())}))},filteredFolders:function(){var e=this;return this.globalSearchDirectories?this.globalSearchDirectories.filter((function(t){return t.dirname.toLowerCase().includes(e.searchFiles.toLowerCase())})):this.getUserDirectories.filter((function(e){return!e.parent_dir})).filter((function(t){return t.dirname.toLowerCase().includes(e.searchFiles.toLowerCase())}))},userDirectories:function(){return this.$store.state.userFolders.directories}}),watch:{$route:function(){this.resetBreadCrumbs()}},mounted:function(){var e=this;this.resetBreadCrumbs();var t=this.isLoggedIn(this);this.$axios.defaults.headers.common.Authorization="Bearer ".concat(t),this.$store.dispatch("fetchUser",this.$route.params.id).then((function(){var t=e.$store.getters.getUserDetails;e.fetchUserFiles(t.user._id,0)})),_.a.$on("filesFetched",this.emitFileLength)},methods:{isImage:function(details){if(details){var e=details.type.split("/")[1];return!!["png","jpeg","jpg","gif","mp4","mp3","webp","svg"].includes(e)}},previewFile:function(e){var t={type:e.file_type,url:e.file_url},data=F({isImage:this.isImage(t)},e);this.previewData=data,this.showPreview=!0},getUserInitials:function(e){if(e){var t=e.split(" ").reduce((function(e,t){return"".concat(e).concat(t[0])}),"");return t.length>2?"".concat(t[0]).concat(t[1]):t}return null},handleFileDelete:function(e){var t=Object(l.a)(e,2),r=t[0],n=t[1];this.fileToDeleteDetails.push(r,n),this.currentFileName=n,this.showDialog=!0},handleFolderDelete:function(e){var t=Object(l.a)(e,2),r=t[0],n=t[1];this.folderToDeleteDetails.push(r,n),this.currentFolderName=n,this.showFolderDialog=!0},deleteFolder:function(e){var t=this;this.showFolderDialog=!1,this.loading=!0;var r=this.$store.getters.getUserDetails;this.$axios.delete("directory/".concat(e)).then((function(){t.loading=!1,t.success.status=!0,t.success.message="Folder has been deleted",t.folderName="",t.fetchUserFiles(r.user._id,0),t.$store.dispatch("fetchUserFolders",r.user._id),t.emitFileLength()})).catch((function(e){t.loading=!1,t.error.status=!0,t.error.message=e.response.data.message}))},deleteFile:function(e){var t=this;this.showDialog=!1;var r=this.$store.getters.getUserDetails;this.loading=!0,this.$axios.delete("/files/".concat(e)).then((function(){t.fetchUserFiles(r.user._id,0),t.loading=!1,t.success.status=!0,t.success.message="File has been deleted"})).catch((function(e){t.loading=!1,t.error.status=!0,t.error.message=e.response.data.message}))},resetBreadCrumbs:function(){this.$store.dispatch("resetAdminBreadCrumbs",this.id)},moveToBin:function(e){var t=this,r=this.$store.getters.getUserDetails;this.loading=!0,this.$axios.post("/super_admin/file/bin",{file_id:e}).then((function(){t.fetchUserFiles(r.user._id,0),t.loading=!1,t.success.status=!0,t.success.message="File has been moved to Bin"})).catch((function(e){t.loading=!1,t.error.status=!0,t.error.message=e.response.data.message}))},moveFolderToBin:function(e){var t=this,r=this.$store.getters.getUserDetails;this.loading=!0,this.$axios.patch("super_admin/directory/bin/".concat(e)).then((function(){t.fetchUser(r.user.ogId),t.loading=!1,t.success.status=!0,t.success.message="Folder has been moved to Bin"})).catch((function(e){t.loading=!1,t.error.status=!0,t.error.message=e.response.data.message}))},showFileDetails:function(e){var t=this,r=Object(l.a)(e,2),n=r[0],o=r[1],c={};this.showDrawer=!0,this.loadingDetails=!0,c.icon=o,this.$axios.get("files/".concat(n)).then((function(e){var data=e.data;t.loadingDetails=!1,c.name=data.file.filename,c.lastUpdated=d()(data.file.updatedAt).fromNow(),c.owner=data.file.user_id.full_name,c.link=data.file.file_url,c.type=data.file.file_type,t.fileDetails=c,t.fileDetails.logs=data.logs}))},showFolderDetails:function(e){var t=this,r={};this.showDrawer=!0,this.loadingDetails=!0,this.$axios.get("directory/".concat(e)).then((function(e){var data=e.data;t.loadingDetails=!1,r.name=data.directory.dirname,r.lastUpdated=d()(data.directory.updatedAt).fromNow(),r.owner=data.directory.user_id.full_name,t.fileDetails=r,t.fileDetails.logs=data.logs}))},emitFileLength:function(){var e=this.filteredFolders.length+this.getFiles.length;_.a.$emit("fileLength",e)}},head:function(){return{title:"Users Drive"}}},y=(r(666),r(21)),x=r(23),C=r.n(x),k=r(186),N=r(115),U=r(193),T=r(11),O=r(417),$=r(423),j=r(187),V=r(573),L=r(154),S=r(160),I=r(419),P=r(188),B=r(116),A=r(5),z=r(427),M=r(48),E=r(421),Y=r(422),J=r(72),G=r(572),component=Object(y.a)(D,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{staticClass:"my-drive",attrs:{"grid-list-md":""}},[e.showPreview?r("Preview",{attrs:{show:e.showPreview,data:e.previewData},on:{hide:function(t){e.showPreview=!1}}}):e._e(),e._v(" "),r("v-navigation-drawer",{staticClass:"py-10",attrs:{temporary:"",right:"",app:"",fixed:"",clipped:"","overlay-opacity":"0.2",width:"300px"},model:{value:e.showDrawer,callback:function(t){e.showDrawer=t},expression:"showDrawer"}},[e.loadingDetails?r("Loader"):r("v-layout",{staticClass:"fill-height",attrs:{column:"","justify-center":"","align-center":""}},[r("img",{attrs:{src:e.fileDetails.icon,alt:"",width:"100px"}}),e._v(" "),r("ul",{staticClass:"px-4 file-details"},[r("li",{staticClass:"my-2"},[r("b",[e._v("File Name: ")]),e._v("\n          "+e._s(e.fileDetails.name)+"\n        ")]),e._v(" "),r("li",{staticClass:"my-2"},[r("b",[e._v("File Owner: ")]),e._v("\n          "+e._s(e.fileDetails.owner)+"\n        ")]),e._v(" "),r("li",{staticClass:"my-2"},[r("b",[e._v("Updated: ")]),e._v("\n          "+e._s(e.fileDetails.lastUpdated)+"\n        ")])]),e._v(" "),r("v-divider",{staticClass:"full-width divider"}),e._v(" "),r("div",{staticClass:"trails"},[r("v-list",e._l(e.fileDetails.logs,(function(t){return r("div",{key:t._id,staticClass:"list my-2"},[r("p",{staticClass:"my-0 pl-6 caption"},[e._v("\n              "+e._s(e._f("date")(t.createdAt))+"\n            ")]),e._v(" "),r("v-list-item",[t.user_id.picture_pic?r("v-avatar",{staticClass:"mx-2",attrs:{size:"35px",item:""}},[r("v-img",{attrs:{src:t.user_id.picture_pic,alt:"User Image"}})],1):r("v-avatar",{staticClass:"mx-2",attrs:{size:"35px",color:"primary",item:""}},[r("span",{staticClass:"white--text font-weight-medium"},[e._v("\n                  "+e._s(e.getUserInitials(t.user_id.full_name))+"\n                ")])]),e._v(" "),r("v-list-item-content",{staticClass:"py-1"},[r("v-list-item-title",{staticClass:"text-capitalize small--text"},[e._v("\n                  "+e._s(t.action)+" this "+e._s(t.type)+"\n                  "+e._s(t.shared_with&&"with "+t.shared_with.full_name)+"\n                ")]),e._v(" "),r("v-list-item-subtitle",{staticClass:"caption"},[e._v("\n                  "+e._s(t.user_id.full_name)+"\n                ")])],1)],1),e._v(" "),r("v-divider",{staticClass:"divider"})],1)})),0)],1),e._v(" "),r("v-layout",{staticClass:"file-actions px-8",attrs:{row:"","justify-space-between":""}},[r("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var l=t.on;return[r("a",e._g({attrs:{href:e.fileDetails.link,download:""}},l),[r("v-icon",{attrs:{color:"primary",dark:""}},[e._v("\n                mdi-cloud-download-outline\n              ")])],1)]}}])},[e._v(" "),r("span",[e._v("Download")])]),e._v(" "),r("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var l=t.on;return[r("a",e._g({attrs:{href:e.fileDetails.link,target:"_blank"}},l),[r("v-icon",{attrs:{color:"primary",dark:""}},[e._v("\n                mdi-open-in-new\n              ")])],1)]}}])},[e._v(" "),r("span",[e._v("Open")])])],1)],1)],1),e._v(" "),e.loading?r("Loader"):e._e(),e._v(" "),e.error.status?r("v-snackbar",{attrs:{timeout:5e3},model:{value:e.error.status,callback:function(t){e.$set(e.error,"status",t)},expression:"error.status"}},[e._v("\n    "+e._s(e.error.message)+"\n    "),r("v-btn",{attrs:{color:"pink",text:""},on:{click:function(t){e.error.status=!1}}},[e._v("\n      Close\n    ")])],1):r("v-snackbar",{attrs:{timeout:5e3},model:{value:e.success.status,callback:function(t){e.$set(e.success,"status",t)},expression:"success.status"}},[e._v("\n    "+e._s(e.success.message)+"\n    "),r("v-btn",{attrs:{color:"green",text:""},on:{click:function(t){e.success.status=!1}}},[e._v("\n      Close\n    ")])],1),e._v(" "),r("v-layout",{attrs:{"align-center":"","justify-space-between":"",row:"",wrap:""}},[r("v-flex",{attrs:{sm12:"",md2:""}},[r("v-select",{staticClass:"shadow",attrs:{items:e.fileTypes,label:"All Types",solo:"",dense:""},model:{value:e.fileType,callback:function(t){e.fileType=t},expression:"fileType"}})],1),e._v(" "),r("v-flex",{attrs:{sm12:"",md3:""}},[r("v-text-field",{staticClass:"shadow",attrs:{label:"Search Files","single-line":"",solo:"","prepend-inner-icon":"mdi-magnify",dense:""},model:{value:e.searchFiles,callback:function(t){e.searchFiles=t},expression:"searchFiles"}})],1)],1),e._v(" "),r("p",{staticClass:"font-weight-medium body-2"},[e._v("\n    Folders ("+e._s(e.filteredFolders.length)+")\n  ")]),e._v(" "),r("div",{staticClass:"files mb-5"},e._l(e.filteredFolders,(function(t,l){return r("SuperAdminFolder",{key:l,staticClass:"my-2",attrs:{"folder-name":t.dirname,"folder-id":t._id,"last-updated":t.updatedAt},on:{deleteFolder:e.handleFolderDelete,moveFolderToBin:e.moveFolderToBin,foldersSelected:function(r){return e.handleMultipleFolders(r,t)},viewDetails:e.showFolderDetails}})})),1),e._v(" "),r("p",{staticClass:"font-weight-medium body-2"},[e._v("Files ("+e._s(e.filteredFiles.length)+")")]),e._v(" "),r("div",{staticClass:"files mb-5"},e._l(e.filteredFiles,(function(t){return r("SuperAdminFile",{key:t.file_url,staticClass:"my-2",attrs:{format:t.file_extension,name:t.filename,"file-id":t._id,size:t.file_size,"last-edited":t.updatedAt},on:{filesSelected:function(r){return e.handleMultipleFiles(r,t)},moveToBin:e.moveToBin,viewDetails:e.showFileDetails,deleteFile:e.handleFileDelete,previewFile:function(r){return e.previewFile(t)}}})})),1),e._v(" "),r("v-dialog",{attrs:{"max-width":"360"},model:{value:e.showFolderDialog,callback:function(t){e.showFolderDialog=t},expression:"showFolderDialog"}},[r("v-card",[r("v-card-title",{staticClass:"headline"},[e._v("\n        Delete Folder\n      ")]),e._v(" "),r("v-card-text",[r("p",[e._v("\n          This is going to permanently remove this folder and all its content\n          from your drive. Enter the file name below to delete.\n          "),r("b",[e._v("File Name: "+e._s(e.currentFolderName))])]),e._v(" "),r("v-text-field",{attrs:{label:"Folder Name"},model:{value:e.folderName,callback:function(t){e.folderName=t},expression:"folderName"}})],1),e._v(" "),r("v-card-actions",[r("v-spacer"),e._v(" "),r("v-btn",{attrs:{color:"darken-1",text:""},on:{click:function(t){e.showFolderDialog=!1}}},[e._v("\n          Cancel\n        ")]),e._v(" "),r("v-btn",{attrs:{color:"red px-5",disabled:!e.folderName||e.folderName!==e.currentFolderName},on:{click:function(t){return e.deleteFolder(e.folderToDeleteDetails[0])}}},[e._v("\n          Delete\n        ")])],1)],1)],1),e._v(" "),r("v-dialog",{attrs:{"max-width":"360"},model:{value:e.showDialog,callback:function(t){e.showDialog=t},expression:"showDialog"}},[r("v-card",[r("v-card-title",{staticClass:"headline"},[e._v("\n        Delete File\n      ")]),e._v(" "),r("v-card-text",[r("p",[e._v("\n          This is going to permanently remove this file from your drive. Enter\n          the file name below to delete.\n          "),r("b",[e._v("File Name: "+e._s(e.currentFileName))])]),e._v(" "),r("v-text-field",{attrs:{label:"File Name"},model:{value:e.fileName,callback:function(t){e.fileName=t},expression:"fileName"}})],1),e._v(" "),r("v-card-actions",[r("v-spacer"),e._v(" "),r("v-btn",{attrs:{color:"darken-1",text:""},on:{click:function(t){e.showDialog=!1}}},[e._v("\n          Cancel\n        ")]),e._v(" "),r("v-btn",{attrs:{color:"red px-5",disabled:!e.fileName||e.fileName!==e.currentFileName},on:{click:function(t){return e.deleteFile(e.fileToDeleteDetails[0])}}},[e._v("\n          Delete\n        ")])],1)],1)],1)],1)}),[],!1,null,"2dab03d1",null);t.default=component.exports;C()(component,{VAvatar:k.a,VBtn:N.a,VCard:U.a,VCardActions:T.a,VCardText:T.b,VCardTitle:T.c,VContainer:O.a,VDialog:$.a,VDivider:j.a,VFlex:V.a,VIcon:L.a,VImg:S.a,VLayout:I.a,VList:P.a,VListItem:B.a,VListItemContent:A.a,VListItemSubtitle:A.b,VListItemTitle:A.c,VNavigationDrawer:z.a,VSelect:M.a,VSnackbar:E.a,VSpacer:Y.a,VTextField:J.a,VTooltip:G.a})}}]);